(this["webpackJsonpblog-app"]=this["webpackJsonpblog-app"]||[]).push([[8],{532:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return v}));var c=n(5),a=n.n(c),r=n(10),o=n(4),s=n(2),u=n(64),l=n(11),i=n(14),f=n(72),j=n(25),b=n(7),p=function(e,t,n,c){var u=Object(s.useState)(0),i=Object(o.a)(u,2),f=i[0],p=i[1],d=Object(s.useState)(null),g=Object(o.a)(d,2),O=g[0],h=g[1],v=Object(s.useState)(null),x=Object(o.a)(v,2),m=x[0],w=x[1],k=Object(l.b)().currentUser,y=Object(s.useState)(""),S=Object(o.a)(y,2),N=(S[0],S[1],k.uid);return Object(s.useEffect)(Object(r.a)(a.a.mark((function n(){var o,s,u;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:console.log(t+" from useStorage.js"),o=j.c.ref(e.name),s=j.b.collection(N),u=function(){var e=Object(r.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="",e.next=3,b.a.get("users/".concat(k.uid,"/profile.json")).then((function(e){console.log(e.data);var n=Object.keys(e.data);console.log(n[0]),t=n[0]})).catch((function(e){return console.log(e)}));case 3:return e.next=5,t;case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),o.put(e).on("state_changed",(function(e){var t=e.bytesTransferred/e.totalBytes*100;p(t)}),(function(e){h(e)}),Object(r.a)(a.a.mark((function e(){var n,l,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.getDownloadURL();case 2:return n=e.sent,l=Object(j.d)(),s.add({url:n,createdAt:l}),w(n),i={imageUrl:n,description:""},e.next=9,b.a.delete("users/".concat(k.uid,"/profile/").concat(t,"/images/").concat(c,".json")).then((function(e){console.log(e)})).catch((function(e){return console.log(e)}));case 9:if(!t){e.next=12;break}return e.next=12,b.a.post("users/".concat(k.uid,"/profile/").concat(t,"/images.json"),i).then((function(e){console.log(e),console.log("img uploaded to firebase DB")})).catch((function(e){return console.log(e)}));case 12:t||u().then(function(){var e=Object(r.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.post("users/".concat(k.uid,"/profile/").concat(t,"/images.json"),i).then((function(e){console.log(e),console.log("img uploaded to firebase DB")})).catch((function(e){return console.log(e)}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 13:case"end":return e.stop()}}),e)}))));case 5:case"end":return n.stop()}}),n)}))),[e]),{progress:f,url:m,error:O}},d=(n(180),n(1));function g(e){var t=e.file,n=e.setFile,c=e.id,u=e.setId,i=Object(s.useState)(!1),f=Object(o.a)(i,2),j=f[0],g=f[1],O=Object(s.useState)(""),h=Object(o.a)(O,2),v=h[0],x=h[1],m=p(t,c,j,v),w=m.url,k=m.progress;console.log(c+" from progressBar.js"),console.log(k,w);var y=Object(l.b)().currentUser;return Object(s.useEffect)(Object(r.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return w&&n(null),e.next=3,b.a.get("users/".concat(y.uid,"/profile.json")).then((function(e){if(console.log(e.data),e.data){var t=Object.keys(e.data);console.log(t),x(t[0]),console.log("there is data"),g(!0)}})).catch((function(e){return console.log(e)}));case 3:console.log(v);case 4:case"end":return e.stop()}}),e)}))),[w,n,u,t]),Object(d.jsx)("div",{className:"progress-bar",style:{width:k+"%"}})}n(115);var O=n(9);var h=n(88);function v(){var e=Object(s.useRef)(),t=Object(s.useRef)(),n=Object(s.useRef)(),c=Object(s.useRef)(),j=Object(s.useRef)(),p=Object(s.useRef)(),v=Object(l.b)(),x=v.currentUser,m=v.updateProfile,w=Object(s.useState)(""),k=Object(o.a)(w,2),y=k[0],S=k[1],N=Object(s.useState)(!1),C=Object(o.a)(N,2),D=C[0],P=C[1],U=Object(s.useState)(null),R=Object(o.a)(U,2),E=R[0],L=R[1],B=Object(i.g)(),F=Object(s.useState)([]),A=Object(o.a)(F,2),G=(A[0],A[1],Object(s.useState)("")),J=Object(o.a)(G,2),T=J[0],I=J[1],M=Object(h.a)(x.uid).docs;function Y(){return(Y=Object(r.a)(a.a.mark((function n(r){var o,s,u,l,i;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r.preventDefault(),console.log(e.current.value),j.current.value===p.current.value){n.next=4;break}return n.abrupt("return",S("Passwords do not match"));case 4:if(o=W,s=ee,u=ue,t.current.value!==s&&(s=t.current.value),e.current.value!==o&&(o=e.current.value),ue||(u=""),l={images:u,location:s,name:o,following:"",followers:""},i=T,c.current.value!==T&&(i=c.current.value),!ae){n.next=21;break}return S(""),P(!0),n.next=18,b.a.put("users/".concat(x.uid,"/profile/").concat(ae,".json"),l).then((function(e){console.log(e.data)})).catch((function(e){return console.log(e)}));case 18:return n.next=20,m(i,j.current.value);case 20:B.push("/profile-blogs");case 21:if(ae){n.next=35;break}return n.prev=22,S(""),P(!0),n.next=27,m(i,j.current.value);case 27:return n.next=29,b.a.post("users/".concat(x.uid,"/profile.json"),l).then((function(e){console.log(e.data)})).catch((function(e){return console.log(e)}));case 29:B.push("/profile-blogs"),n.next=35;break;case 32:n.prev=32,n.t0=n.catch(22),S("Failed to update account, ".concat(n.t0));case 35:P(!1);case 36:case"end":return n.stop()}}),n,null,[[22,32]])})))).apply(this,arguments)}var _=function(){var e=Object(r.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={images:"",location:"",name:"",following:"",followers:""},e.next=3,b.a.post("users/".concat(x.uid,"/profile.json"),t).then((function(e){console.log(e.data)})).catch((function(e){return console.log(e)}));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();console.log(x.uid);var q=Object(s.useState)(!1),z=Object(o.a)(q,2),H=z[0],K=z[1],Q=Object(s.useState)(""),V=Object(o.a)(Q,2),W=V[0],X=V[1],Z=Object(s.useState)(""),$=Object(o.a)(Z,2),ee=$[0],te=$[1],ne=Object(s.useState)(""),ce=Object(o.a)(ne,2),ae=ce[0],re=ce[1],oe=Object(s.useState)([]),se=Object(o.a)(oe,2),ue=se[0],le=se[1],ie=Object(s.useState)(null),fe=Object(o.a)(ie,2),je=fe[0],be=fe[1],pe=function(e,t,n){var c=Object(s.useState)(null),u=Object(o.a)(c,2),i=u[0],f=u[1],j=Object(s.useState)(null),p=Object(o.a)(j,2),d=p[0],g=(p[1],Object(l.b)().currentUser),h=new Date,v=(h.getMonth(),String(h.getDate()).padStart(2,"0"),h.getFullYear(),function(){var e=Object(r.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="",e.next=3,b.a.get("users/".concat(g.uid,"/profile.json")).then((function(e){console.log(e.data);var n=Object.keys(e.data);console.log(n[0]),t=n[0]})).catch((function(e){return console.log(e)}));case 3:return e.next=5,t;case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}());return Object(s.useEffect)(Object(r.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("id is: ".concat(t)+" from GetData page"),console.log("grabs data from GetData page"),!t){e.next=5;break}return e.next=5,b.a.get("users/".concat(g.uid,"/profile/").concat(t,"/images.json")).then((function(e){console.log(e);var t=[];for(var n in e.data)console.log(n),t.unshift(Object(O.a)(Object(O.a)({},e.data[n]),{},{id:n}));f(t)})).catch((function(e){return console.log(e)}));case 5:t||v().then(function(){var e=Object(r.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.get("users/".concat(g.uid,"/profile/").concat(t,"/images.json")).then((function(e){console.log(e);var t=[];for(var n in e.data)console.log(n),t.unshift(Object(O.a)(Object(O.a)({},e.data[n]),{},{id:n}));f(t)})).catch((function(e){return console.log(e)}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 6:case"end":return e.stop()}}),e)}))),[e,n]),{datas:i,changed:d}}(M,ae,je).datas;console.log(pe),console.log(H),Object(s.useEffect)(Object(r.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.get("users/".concat(x.uid,"/profile.json")).then((function(e){console.log(e.data);var t="",n="";e.data||console.log("There is no data"),e.data&&(t=Object.values(e.data),n=Object.keys(e.data),console.log(t),console.log(n),K(!0)),W||t&&X(t[0].name),ee||t&&te(t[0].location),re(n[0]),le(t[0].images),I(x.email)})).catch((function(e){return console.log(e)}));case 2:case"end":return e.stop()}}),e)}))),[pe]);var de=function(){var e=Object(r.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,b.a.delete("users/".concat(x.uid,"/profile/").concat(ae,"/images/").concat(pe[0].id,".json")).then((function(e){console.log(e.data),be("changed")})).catch((function(e){return console.log(e)}));case 3:n.current.value=null;case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();console.log(pe);var ge="";if(pe||(ge=Object(d.jsx)("div",{})),null!==pe&&pe.length>0){var Oe=Object.values(pe[0]);console.log(Oe),ge=Object(d.jsxs)("div",{className:"img",children:[Object(d.jsx)("img",{src:Oe[1]},pe[0].id),Object(d.jsx)("button",{onClick:de,children:"Delete"})]})}return console.log(ue),console.log(W),console.log(ae),Object(d.jsx)("div",{className:"container",children:Object(d.jsxs)("div",{className:"signUp",children:[Object(d.jsx)("figure",{children:Object(d.jsx)("img",{src:u.a,alt:"adventures with chu"})}),Object(d.jsx)("h1",{children:"Edit Profile"}),y&&Object(d.jsx)(f.a,{message:y}),Object(d.jsxs)("form",{children:[Object(d.jsxs)("div",{className:"input-form",children:[Object(d.jsx)("label",{children:"Profile Name:"}),Object(d.jsx)("input",{type:"text",ref:e,value:W,onChange:function(e){return X(e.target.value)}})]}),Object(d.jsxs)("div",{className:"input-form",children:[Object(d.jsx)("label",{children:"Location:"}),Object(d.jsx)("input",{type:"text",ref:t,value:ee,onChange:function(e){return te(e.target.value)}})]}),Object(d.jsxs)("div",{className:"input-form",children:[Object(d.jsx)("label",{children:"Profile Picture:"}),Object(d.jsx)("input",{type:"file",accept:"image/png, image/jpeg",onChange:function(e){0==H&&_();var t=e.target.files[0];t&&["image/png","image/jpeg"].includes(t.type)?(L(t),S("")):(L(null),S("Please select an image file (png or jpeg)"))},ref:n}),E&&Object(d.jsx)("div",{children:E.name}),E&&Object(d.jsx)(g,{file:E,setFile:L,id:ae})]}),ge,Object(d.jsxs)("div",{className:"input-form",children:[Object(d.jsx)("label",{children:"Email Address"}),Object(d.jsx)("input",{type:"email",ref:c,value:T,onChange:function(e){return I(e.target.value)}})]}),Object(d.jsxs)("div",{className:"input-form",children:[Object(d.jsx)("label",{children:"Password"}),Object(d.jsx)("input",{type:"password",ref:j,minLength:"6",autoComplete:"off",placeholder:"Leave blank to keep original"})]}),Object(d.jsxs)("div",{className:"input-form",children:[Object(d.jsx)("label",{children:"Confirm New Password"}),Object(d.jsx)("input",{type:"password",ref:p,minLength:"6",autoComplete:"off",placeholder:"Leave blank to keep original"})]}),Object(d.jsx)("button",{disabled:D,type:"submit",className:"button",onClick:function(e){return Y.apply(this,arguments)},children:"Update"})]}),Object(d.jsx)("div",{className:"login",children:Object(d.jsx)("p",{children:Object(d.jsx)("span",{children:Object(d.jsx)("a",{href:"/profile-blogs",children:"Cancel"})})})})]})})}}}]);
//# sourceMappingURL=8.394188fe.chunk.js.map